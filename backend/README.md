# üó°Ô∏è Librarium Backend - API RPG de H√°bitos

Backend do Librarium, um gerenciador de h√°bitos gamificado com tem√°tica dark fantasy inspirado em Hollow Knight e Devil May Cry.

## üéÆ Caracter√≠sticas

- **Sistema de Gamifica√ß√£o**: XP, n√≠veis, t√≠tulos e avatares evolutivos
- **Autentica√ß√£o JWT**: Sistema seguro de login e registro
- **CRUD Completo**: Gerenciamento completo de h√°bitos e progresso
- **Estat√≠sticas Avan√ßadas**: Gr√°ficos, heatmaps e an√°lises detalhadas
- **Sistema de Conquistas**: Desbloqueio de achievements baseado em progresso
- **API RESTful**: Endpoints bem estruturados e documentados
- **Tema Dark Fantasy**: Mensagens e terminologia imersivas

## üèóÔ∏è Tecnologias

- **Node.js** + **Express.js** - Framework web
- **MongoDB** + **Mongoose** - Banco de dados NoSQL
- **JWT** - Autentica√ß√£o segura
- **bcrypt** - Criptografia de senhas
- **Helmet** + **CORS** - Seguran√ßa e configura√ß√£o
- **Rate Limiting** - Prote√ß√£o contra spam

## üì¶ Instala√ß√£o

### Pr√©-requisitos
- Node.js (v16 ou superior)
- MongoDB (local ou MongoDB Atlas)
- npm ou yarn

### Passos

1. **Clone o reposit√≥rio**
```bash
git clone <seu-repositorio>
cd librarium/backend
```

2. **Instale as depend√™ncias**
```bash
npm install
```

3. **Configure as vari√°veis de ambiente**
```bash
cp .env.example .env
```

Edite o arquivo `.env` com suas configura√ß√µes:
```env
NODE_ENV=development
PORT=3000
MONGODB_URI=mongodb://localhost:27017/librarium
JWT_SECRET=sua_chave_secreta_super_forte_aqui
JWT_EXPIRES_IN=7d
FRONTEND_URL=http://localhost:3001
```

4. **Inicie o servidor**
```bash
# Desenvolvimento (com nodemon)
npm run dev

# Produ√ß√£o
npm start
```

## üöÄ Endpoints da API

### üîê Autentica√ß√£o (`/api/auth`)

| M√©todo | Endpoint | Descri√ß√£o |
|--------|----------|-----------|
| POST | `/registrar` | Registrar novo usu√°rio |
| POST | `/login` | Fazer login |
| GET | `/perfil` | Obter perfil do usu√°rio |
| PUT | `/perfil` | Atualizar perfil |
| GET | `/verificar` | Verificar token |

### ‚öîÔ∏è H√°bitos (`/api/habitos`)

| M√©todo | Endpoint | Descri√ß√£o |
|--------|----------|-----------|
| GET | `/` | Listar h√°bitos do usu√°rio |
| POST | `/` | Criar novo h√°bito |
| GET | `/:id` | Obter h√°bito espec√≠fico |
| PUT | `/:id` | Atualizar h√°bito |
| DELETE | `/:id` | Deletar h√°bito |
| POST | `/:id/concluir` | Marcar h√°bito como conclu√≠do |
| GET | `/:id/progresso` | Obter progresso do h√°bito |

### üë§ Usu√°rios (`/api/usuarios`)

| M√©todo | Endpoint | Descri√ß√£o |
|--------|----------|-----------|
| GET | `/dashboard` | Dashboard do usu√°rio |
| GET | `/estatisticas` | Estat√≠sticas detalhadas |
| GET | `/ranking` | Ranking de usu√°rios |
| GET | `/conquistas` | Conquistas do usu√°rio |
| PUT | `/preferencias` | Atualizar prefer√™ncias |

### üìä Estat√≠sticas (`/api/estatisticas`)

| M√©todo | Endpoint | Descri√ß√£o |
|--------|----------|-----------|
| GET | `/sistema` | Estat√≠sticas gerais |
| GET | `/grafico-semanal` | Gr√°fico dos √∫ltimos 7 dias |
| GET | `/categorias` | Estat√≠sticas por categoria |
| GET | `/heatmap` | Heatmap de atividades |
| GET | `/comparativo-mensal` | Comparativo mensal |

## üéØ Modelos de Dados

### Usu√°rio
```javascript
{
  nomeUsuario: String,
  email: String,
  senha: String (criptografada),
  experiencia: Number,
  nivel: Number,
  titulo: String,
  avatar: String,
  personalizacaoAvatar: {
    arma: String,
    armadura: String,
    acessorio: String
  },
  sequencia: {
    atual: Number,
    maiorSequencia: Number
  },
  preferencias: {
    notificacoes: Boolean,
    tema: String,
    idioma: String
  }
}
```

### H√°bito
```javascript
{
  idUsuario: ObjectId,
  titulo: String,
  descricao: String,
  frequencia: String, // 'diario', 'semanal', 'mensal'
  categoria: String, // 'saude', 'estudo', 'trabalho', etc
  dificuldade: String, // 'facil', 'medio', 'dificil', 'lendario'
  recompensaExperiencia: Number,
  icone: String,
  cor: String,
  ativo: Boolean,
  sequencia: {
    atual: Number,
    maiorSequencia: Number
  },
  estatisticas: {
    totalConclusoes: Number,
    totalPerdidos: Number,
    taxaConclusao: Number
  }
}
```

### Progresso
```javascript
{
  idHabito: ObjectId,
  idUsuario: ObjectId,
  data: Date,
  status: String, // 'concluido', 'perdido', 'parcial'
  observacoes: String,
  experienciaGanha: Number,
  dificuldade: String
}
```

## üèÜ Sistema de Gamifica√ß√£o

### N√≠veis e T√≠tulos
- **N√≠vel 1-10**: Aspirante (100 XP por n√≠vel)
- **N√≠vel 11-20**: Ca√ßador
- **N√≠vel 21-30**: Guardi√£o do Librarium
- **N√≠vel 31+**: Conjurador Supremo

### Recompensas por Dificuldade
- **F√°cil**: 10 XP
- **M√©dio**: 20 XP
- **Dif√≠cil**: 35 XP
- **Lend√°rio**: 50 XP

## üîí Seguran√ßa

- Senhas criptografadas com bcrypt (salt 12)
- Tokens JWT com expira√ß√£o configur√°vel
- Rate limiting (100 requests/15min por IP)
- Helmet para headers de seguran√ßa
- Valida√ß√£o de entrada em todos os endpoints

## üß™ Testando a API

### Verificar se o servidor est√° funcionando
```bash
curl http://localhost:3000/api/saude
```

### Registrar um usu√°rio
```bash
curl -X POST http://localhost:3000/api/auth/registrar \
  -H "Content-Type: application/json" \
  -d '{"nomeUsuario":"testuser","email":"test@example.com","senha":"123456"}'
```

### Fazer login
```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","senha":"123456"}'
```

## üöß Pr√≥ximos Passos (Roadmap)

### MVP Conclu√≠do ‚úÖ
- [x] Sistema de autentica√ß√£o
- [x] CRUD de h√°bitos
- [x] Sistema de XP/n√≠veis
- [x] Progresso e estat√≠sticas b√°sicas

### Vers√£o Intermedi√°ria üîÑ
- [ ] Sistema de conquistas autom√°ticas
- [ ] Notifica√ß√µes (via webhook/email)
- [ ] Avatar evolutivo visual
- [ ] Exporta√ß√£o de dados

### Vers√£o Avan√ßada üéØ
- [ ] Ranking multiplayer
- [ ] Sistema de batalhas de h√°bitos
- [ ] Integra√ß√£o com calend√°rios
- [ ] Modo offline-first

## üêõ Logs e Debug

O servidor registra todas as atividades importantes. Em desenvolvimento, os erros s√£o exibidos com stack trace completo.

```bash
# Ver logs em tempo real
npm run dev
```

## üìù Contribui√ß√£o

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/nova-feature`)
3. Commit suas mudan√ßas (`git commit -m 'Adiciona nova feature'`)
4. Push para a branch (`git push origin feature/nova-feature`)
5. Abra um Pull Request

## üìÑ Licen√ßa

MIT License - veja o arquivo LICENSE para detalhes.

---

**üéÆ Que a ca√ßada comece! Bem-vindo ao Librarium!** ‚öîÔ∏è
